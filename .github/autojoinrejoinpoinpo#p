local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")
local PlaceId = 14916516914

local function AttemptRejoin(retryCount)
    retryCount = retryCount or 0
    if retryCount < 3 then  -- Limit retries to prevent looping indefinitely
        print("Rejoining attempt:", retryCount + 1)
        task.wait(2)
        TeleportService:Teleport(PlaceId)
    else
        print("Failed to rejoin after multiple attempts.")
    end
end

-- Detecting ErrorPrompt in CoreGui
repeat task.wait() until CoreGui:FindFirstChild("RobloxPromptGui")

local promptOverlay = CoreGui.RobloxPromptGui:FindFirstChild("promptOverlay")
if promptOverlay then
    promptOverlay.ChildAdded:Connect(function(child)
        if child.Name == "ErrorPrompt" then
            print("Detected disconnection or kick! Attempting to rejoin...")
            AttemptRejoin(1)
        end
    end)
end

-- Alternative: Detecting player removal (for a broader range of disconnects)
Players.PlayerRemoving:Connect(function(player)
    if player == Players.LocalPlayer then
        print("Detected player removal. Attempting to rejoin...")
        AttemptRejoin(1)
    end
end)
